{% extends "base.html" %}

{% block title %}Favor{% endblock %}

{% block content %}
    <h1>{{ object.title }}</h1>
    <p><a href={% url "barter:user_detail" object.author.pk %}><b>{{ object.author }}</b></a>: {{ object.message }}</p>
    <div>{{ hello }}</div>
    {% if object.author.pk != user.pk %}
        <a class="btn btn-default" href={% url "barter:create_offer" object.pk user.pk %}>Reply with an offer</a>
        <br/>
    {% endif %}
    <br/>
    {% if object.offers.count > 0 %}
        <h4>Current offers</h4>
        <div>
            {% for offer in offer_threads %}
                <div style="margin-bottom: 5px">
                    <a href={% url "barter:user_detail" offer.trader_id %}><b>{{ offer.email }}</b></a>: {{ offer.message }}
                    {% if object.author.pk == user.pk %}
                        <a class="btn btn-default btn-sm" href={% url "barter:create_offer" object.pk offer.trader_id %}>Reply</a>
                        <form action={% url "barter:accept_offer" object.pk offer.trader_id %} method="POST" style="display: inline-block">
                            {% csrf_token %}
                            <input type="hidden" name="trader" value="{{ offer.trader_id }}"/>
                            <input type="submit" class="btn btn-default btn-sm" value="Accept" name="acceptbtn" />
                        </form>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <h4>No offers yet</h4>
    {% endif %}

{% endblock %}